<% unless @facets.blank? %>
  <%
    preferred_facet_order = %w(repository classification_paths subjects published_agents langcode primary_type)
    ordered_facet_types = @facets.keys.sort{|a,b|
      if preferred_facet_order.include?(a) && preferred_facet_order.include?(b)
        preferred_facet_order.index(a) <=> preferred_facet_order.index(b)
      elsif preferred_facet_order.include?(a)
        -1
      elsif preferred_facet_order.include?(b)
        1
      else
        0
      end
    }
  %>

  <% ordered_facet_types.each do |type| %>
    <%
      facet_group = @facets.fetch(type, false)
      max_facets_on_load = 5
    %>
    <div id="<%= t("search_results.filter.#{type}").downcase %>-facet">
      <h4><%= t("search_results.filter.#{type}") %></h4>
      <% if facet_group.length <= max_facets_on_load %>
        <ul>
        <% facet_group.each do |facet| %>
          <%= render partial: 'shared/facet_description', locals: { type: type, facet: facet } %>
        <% end %>
        </ul>
      <% else %>
        <ul>
        <% facet_group.slice(0, max_facets_on_load).each do |facet| %>
          <%= render partial: 'shared/facet_description', locals: { type: type, facet: facet } %>
        <% end %>
        </ul>
        <div class="more-facets">
          <button type="button" class="more-facets__more bgsu_common_button bgsu_common_button__small">
            <%= t('search_results.more_facets') %> <i class="fa fa-chevron-down"></i>
          </button>
          <div class="more-facets__facets">
            <ul>
            <% facet_group.slice(max_facets_on_load, facet_group.length - 1).each do |facet| %>
              <%= render partial: 'shared/facet_description', locals: { type: type, facet: facet } %>
            <% end %>
            </ul>
          </div>
          <button type="button" class="more-facets__less bgsu_common_button bgsu_common_button__small">
            <%= t('search_results.fewer_facets') %> <i class="fa fa-chevron-up"></i>
          </button>
        </div>
      <% end %>
    </div>
  <% end %>
<% end %>
